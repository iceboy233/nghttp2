package(default_visibility = ["//visibility:public"])

cc_library(
    name = "asio_http2_client",
    srcs = [
        "asio_client_request.cc",
        "asio_client_request_impl.cc",
        "asio_client_request_impl.h",
        "asio_client_response.cc",
        "asio_client_response_impl.cc",
        "asio_client_response_impl.h",
        "asio_client_session.cc",
        "asio_client_session_impl.cc",
        "asio_client_session_impl.h",
        "asio_client_session_tcp_impl.cc",
        "asio_client_session_tcp_impl.h",
        "asio_client_session_tls_impl.cc",
        "asio_client_session_tls_impl.h",
        "asio_client_stream.cc",
        "asio_client_stream.h",
        "asio_client_tls_context.cc",
        "asio_client_tls_context.h",
    ],
    hdrs = ["includes/nghttp2/asio_http2_client.h"],
    includes = ["includes"],
    deps = [
        ":asio_http2",
        "@boringssl//:ssl",
    ],
)

cc_library(
    name = "asio_http2_server",
    srcs = [
        "asio_io_service_pool.cc",
        "asio_io_service_pool.h",
        "asio_server.cc",
        "asio_server.h",
        "asio_server_connection.h",
        "asio_server_http2.cc",
        "asio_server_http2_handler.cc",
        "asio_server_http2_handler.h",
        "asio_server_http2_impl.cc",
        "asio_server_http2_impl.h",
        "asio_server_request.cc",
        "asio_server_request_handler.cc",
        "asio_server_request_handler.h",
        "asio_server_request_impl.cc",
        "asio_server_request_impl.h",
        "asio_server_response.cc",
        "asio_server_response_impl.cc",
        "asio_server_response_impl.h",
        "asio_server_serve_mux.cc",
        "asio_server_serve_mux.h",
        "asio_server_stream.cc",
        "asio_server_stream.h",
        "asio_server_tls_context.cc",
        "asio_server_tls_context.h",
    ],
    hdrs = ["includes/nghttp2/asio_http2_server.h"],
    includes = ["includes"],
    deps = [
        ":asio_http2",
        "@boringssl//:ssl",
        "@org_boost_boost//:thread",
    ],
)

cc_library(
    name = "asio_http2",
    srcs = [
        "allocator.h",
        "asio_common.cc",
        "asio_common.h",
        "http2.cc",
        "http2.h",
        "network.h",
        "nghttp2_config.h",
        "template.h",
        "timegm.h",
        "tls.h",
        "util.cc",
        "util.h",
    ],
    hdrs = ["includes/nghttp2/asio_http2.h"],
    includes = ["includes"],
    deps = [
        "//nghttp2/lib:nghttp2",
        "//nghttp2_asio/third-party:url-parser",
        "@org_boost_boost//:asio",
    ],
)
